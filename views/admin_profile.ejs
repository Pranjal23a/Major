<link rel="stylesheet" type="text/css" href="/css/admin_profile.css">
<div class="main-container">
    <!-- <div class="title-edit">
        <h1>
            <%= title %>
        </h1>
    </div> -->
    <% if(locals.user){ %>
        <div>
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01"
                    aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
                    <a class="navbar-brand" href=" /admin/profile">Add Inventory</a>
                    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                        <li class="nav-item active">

                            <a class="nav-link" href=" /admin/search">Search Inventory <span
                                    class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item">

                            <a class="nav-link" href=" /admin/profile/selldata">Details</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href=" /admin/staff/sign-up">Add Staff </button></a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>

        <!-- in buttons ko as a list add krio left side mai -->
        <!-- <div class="dropdown-container">
            <div class="container">
                <div class="custom-dropdown">
                    <button class="btn btn-secondary" id="dropdownToggle" type="button">
                        Dropdown button
                    </button>
                    <div class="dropdown-menu dropdown-menu-right dropdown-menu-up" aria-labelledby="dropdownToggle">
                        <a class="dropdown-item" href=" /admin/profile">Add Inventory</a>
                        <a class="dropdown-item" href=" /admin/search">Search Inventory</a>
                        <a class="dropdown-item" href=" /admin/profile/selldata">Details</a>
                        <a class="dropdown-item" href=" /admin/staff/sign-up">Add Staff </button></a>
                    </div>
                </div>
            </div>
        </div> -->



        <!-- <div
                <a href=" /admin/profile"><button>Add Inventory</button></a>
                <a href=" /admin/search"><button>Search Inventory</button></a>
                <a href=" /admin/profile/selldata"><button>Details</button></a>
                <a href=" /admin/staff/sign-up"><button> Add Staff </button></a> -->


        <div class="title-edit">
            <h3>Add Inventory</h3>
        </div>
        <div class="form-container">
            <form action="/inventory/add" method="POST">
                <div class="form-style">
                    <input class="form-style-place" type="text" name="medicine_id" placeholder="Medicine ID" required>
                    <input class="form-style-place" type="text" name="name" placeholder="Name" required>
                    <input class="form-style-place" type="date" name="exp_date" placeholder="Expiry Date" required>
                    <input class="form-style-place" type="number" name="stock" placeholder="Stock Unit" required>
                    <input class="form-style-place" type="text" name="price" placeholder="Price" required>
                    <input class="enter" type="submit" value="Add">
                </div>
            </form>
        </div>


        <table border="1" style="text-align: center;">
            <thead>
                <th>Sno.</th>
                <th>Medicine ID</th>
                <th>Name</th>
                <th>Stock</th>
                <th>Price(per Unit)</th>
                <th>Expiry Date</th>
                <th></th>
            </thead>
            <tbody>
                <% let i=1 %>
                    <% for(info of data){%>
                        <tr>
                            <td>
                                <%= i %>
                            </td>
                            <td>
                                <%= info.medicine_id %>
                            </td>
                            <td>
                                <%= info.name%>
                            </td>
                            <td>
                                <%= info.stock %>
                            </td>
                            <td>
                                Rs. <%= info.price %>
                            </td>
                            <td style="<%=checkExpiration(info.exp_date) %>">
                                <%= new Date(info.exp_date).toLocaleDateString('en-US', { year: 'numeric' ,
                                    month: 'short' , day: 'numeric' }) %>
                            </td>
                            <td><a href="/admin/destroy/<%= info.id %>">X</a></td>
                        </tr>
                        <%i++ } %>
            </tbody>
        </table>
        <% } %>

</div>
<script>
           <% function checkExpiration(expDate) {
        var currentDate = new Date();
        var expirationDate = new Date(expDate);
        var timeDifference = expirationDate - currentDate;
        var daysUntilExpiration = Math.floor(timeDifference / (1000 * 60 * 60 * 24));

        if (daysUntilExpiration < 0) {
            return " background-color: red;";
        } else if (daysUntilExpiration <= 30) {
            return "background-color: orange;";
        } else { return ""; }
    } %>

        $(document).ready(function () {
            $('#dropdownToggle').click(function () {
                $('.dropdown-menu').toggle(); // Toggle the display of the dropdown menu
            });
        });
</script>