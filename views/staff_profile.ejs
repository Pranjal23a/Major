<link rel="stylesheet" type="text/css" href="/css/staff_profile.css">
<% if(locals.user){ %>
    <div class="main-container">

        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01"
                aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo01">

                <a class="navbar-brand" href=" /staff/profile">Update Inventory</a>
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                    <li class="nav-item active">

                        <a class="nav-link" href=" /staff/search">Search Inventory <span
                                class="sr-only">(current)</span></a>

                    </li>
                    <li class="nav-item ">

                        <a class="nav-link" href=" /staff/patient">View Patient <span
                                class="sr-only">(current)</span></a>
                    </li>

                </ul>
            </div>
        </nav>





        <!-- isko bhi side mai as a list add krio -->

        <div class="container-fluid">
            <div class="row">
                <div class="col">

                    <div class="title-edit">
                        <h3>Update Inventory</h3>
                    </div>

                    <div class="form-container">
                        <form action="/inventory/drop" method="POST">
                            <div class="form-style">
                                <input class="form-style-place" type="text" name="medicine_id" placeholder="Medicine ID"
                                    required>
                                <input class="form-style-place" type="number" name="stock" placeholder="Unit Sell"
                                    required>
                                <input class="enter" type="submit" value="Update">
                            </div>
                        </form>
                    </div>
                </div>
                <div class="col">
                    <table border="1" style="text-align: center;">
                        <thead>
                            <th>Medicine ID</th>
                            <th>Name</th>
                            <th>Stock</th>
                            <th>Price(per Unit)</th>
                            <th>Expiry Date</th>
                        </thead>
                        <tbody>
                            <% for(info of data){%>
                                <tr>
                                    <td>
                                        <%= info.medicine_id %>
                                    </td>
                                    <td>
                                        <%= info.name%>
                                    </td>
                                    <td>
                                        <%= info.stock %> U
                                    </td>
                                    <td>
                                        Rs. <%= info.price %>
                                    </td>
                                    <td style="<%=checkExpiration(info.exp_date) %>">
                                        <%= new Date(info.exp_date).toLocaleDateString('en-US', { year: 'numeric' ,
                                            month: 'short' , day: 'numeric' }) %>
                                    </td>
                                </tr>
                                <% } %>
                        </tbody>
                    </table>

                </div>
            </div>
        </div>


    </div>

    <% } %>
        <script>
        <% function checkExpiration(expDate) {
                var currentDate = new Date();
                var expirationDate = new Date(expDate);
                var timeDifference = expirationDate - currentDate;
                var daysUntilExpiration = Math.floor(timeDifference / (1000 * 60 * 60 * 24));

                if (daysUntilExpiration < 0) {
                    return " background-color: red;";
                } else if (daysUntilExpiration <= 30) {
                    return "background-color: orange;";
                } else { return ""; }
            } %>
        </script>


        <script>
    <% function checkExpiration(expDate) {
                    var currentDate = new Date();
                    var expirationDate = new Date(expDate);
                    var timeDifference = expirationDate - currentDate;
                    var daysUntilExpiration = Math.floor(timeDifference / (1000 * 60 * 60 * 24));

                    if (daysUntilExpiration < 0) {
                        return " background-color: red;";
                    } else if (daysUntilExpiration <= 30) {
                        return "background-color: orange;";
                    } else { return ""; }
                } %>

                $(document).ready(function () {
                    $('#dropdownToggle').click(function () {
                        $('.dropdown-menu').toggle(); // Toggle the display of the dropdown menu
                    });
                });
        </script>